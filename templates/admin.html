<!DOCTYPE html>
<html>
  <head>
    <title>Admin - Qu·∫£n l√Ω danh s√°ch m√°y</title>
    <style>
      /* ========================= C·∫§U H√åNH CSS ========================= */
      body {
        font-family: Arial, sans-serif;
        background: #f4f4f4;
        padding: 20px;
      }

      h1,
      h2 {
        color: #333;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      table,
      th,
      td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: center;
      }

      th {
        background: #4caf50;
        color: white;
      }

      button {
        background: #4caf50;
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
        border-radius: 5px;
      }

      button:hover {
        background: #367c39;
      }

      .delete-btn {
        background: red;
      }

      .delete-btn:hover {
        background: darkred;
      }

      input {
        padding: 5px;
        margin-right: 10px;
      }

      .flash {
        color: green;
        font-weight: bold;
        margin-bottom: 10px;
      }

      /* ƒê·ªãnh d·∫°ng m√†u cho tr·∫°ng th√°i h·∫øt h·∫°n */
      .expired {
        color: red;
        font-weight: bold;
      }

      .active {
        color: green;
        font-weight: bold;
      }

      .permanent {
        color: #4caf50;
        font-weight: bold;
      }

      form {
        display: inline;
      }
    </style>
  </head>

  <body>
    <!-- ========================= TI√äU ƒê·ªÄ ========================= -->
    <h1>Qu·∫£n l√Ω danh s√°ch m√°y h·ª£p l·ªá</h1>

    <!-- Flash message th√¥ng b√°o th√†nh c√¥ng -->
    {% with messages = get_flashed_messages() %} {% if messages %}
    <div class="flash">{{ messages[0] }}</div>
    {% endif %} {% endwith %}

    <!-- ========================= DANH S√ÅCH M√ÅY CH·ªú DUY·ªÜT ========================= -->
    <h2>Danh s√°ch m√°y ch·ªù duy·ªát</h2>
    <table>
      <tr>
        <th>Hostname</th>
        <th>MAC Address</th>
        <th>H·∫øt h·∫°n</th>
        <th>H√†nh ƒë·ªông</th>
      </tr>
      {% for machine in pending_machines %}
      <tr>
        <td>{{ machine.hostname }}</td>
        <td>{{ machine.mac }}</td>
        <td>
          <form action="/approve_machine/{{ machine.mac }}" method="post">
            <input type="datetime-local" name="expiry_date" required />
            <button type="submit">‚úîÔ∏è Duy·ªát</button>
          </form>
        </td>
        <td>
          <a href="/delete_pending/{{ machine.mac }}">
            <button class="delete-btn">‚ùå X√≥a</button>
          </a>
        </td>
      </tr>
      {% endfor %}
    </table>

    <!-- ========================= DANH S√ÅCH M√ÅY H·ª¢P L·ªÜ ========================= -->
    <h2>Danh s√°ch m√°y h·ª£p l·ªá</h2>
    <table border="1">
      <tr>
        <th>Hostname</th>
        <th>MAC Address</th>
        <th>Ng√†y h·∫øt h·∫°n</th>
        <th>H√†nh ƒë·ªông</th>
      </tr>
      {% for machine in allowed_machines %}
      <tr>
        <td>{{ machine.hostname }}</td>
        <td>{{ machine.mac }}</td>
        <td>
          <form
            action="{{ url_for('edit_expiry', mac=machine.mac) }}"
            method="post"
            style="display: inline"
          >
            <input
              type="datetime-local"
              name="new_expiry_date"
              value="{{ machine.expiry_date.replace(' ', 'T') }}"
              required
            />
            <button type="submit">üíæ L∆∞u</button>
          </form>
        </td>
        <td>
          <a href="{{ url_for('delete_machine', mac=machine.mac) }}">‚ùå X√≥a</a>
          |
          <a href="{{ url_for('set_permanent', mac=machine.mac) }}"
            >‚≠ê Vƒ©nh vi·ªÖn</a
          >
        </td>
      </tr>
      {% endfor %}
    </table>

    <!-- ========================= FORM TH√äM M√ÅY TH·ª¶ C√îNG ========================= -->
    <h2>Th√™m m√°y m·ªõi (th·ªß c√¥ng)</h2>
    <form action="/add_machine" method="post">
      <input type="text" name="hostname" placeholder="Hostname" required />
      <input type="text" name="mac" placeholder="MAC Address" required />
      <button type="submit">Th√™m m√°y</button>
    </form>
  </body>
</html>

<a
  href="/logout"
  style="float: right; margin-top: -40px; color: red; font-weight: bold"
  >üëã ƒêƒÉng xu·∫•t</a
>
